rm(list = ls())
cat("\014")
graphics.off()

set.seed(123)

#----------------------------
#Install and load packages:
#----------------------------
instll <- c("xtable", "maxLik", "Renext","miscTools","plm","EnvStats","MASS","actuar","evmix")
instlld <- dimnames(installed.packages())[[1]]
for (i in 1:length(instll)) {
  if (!(instll[i] %in% instlld)) {
    install.packages(instll[i])
  }
  library(instll[i], character.only = TRUE)
}

#----------------------------
#raw moments
muk <- function(x, k) {
  mean(x ^ k)
}

#----------------------------
#Lomax distribution function
pLomax <- function(q, beta, sigma) {
  1 - (sigma / (q + sigma)) ^ beta
}
#----------------------------
#Lomax quantile function
qLomax <- function(x, beta, sigma) {
  sigma * ((1 - x) ^ (-1 / beta) - 1)
}
#----------------------------
#Lomax density function
dLomax <- function(x, beta, sigma) {
  (beta * sigma ^ beta) / ((x + sigma) ^ (beta + 1))
}
#----------------------------
#Lomax random number generator
rLomax <- function(n, beta, sigma) {
  U <- runif(n)
  qLomax(U, beta, sigma)
}
#----------------------------
#Log-likelihood function (Lomax) # used in maxLik()
llik <- function(param, x) {
  beta <- param[1]
  sigma <- param[2]
  if (beta > 0 & sigma > 0) {
    ans <- log(beta) - log(sigma) - (1 + beta) * (log(1 + x / sigma))
  } else{
    ans <- NA
  }
}

#----------------------------
#Different phi function choices
phi.kl <- function(t) {
  -log(t)
} #Should be t*log(t), but there are numerical complications
#----------------------------
phi.chisq <- function(t) {
  (1 - t) ^ 2
}
#----------------------------
phi.tv <- function(t) {
  abs(t - 1)
}
#--------------------------------------------------
#Method of moments estimator
MME <- function(x) {
  n <- length(x)
  x <- sort(x)
  mu1 <- mean(x)
  mu2 <- mean(x^2)
  b <- 2*(mu2 - mu1^2)/(mu2 - 2* mu1 ^ 2)
  s <- mu1 * (b - 1)
  ans2 <- c(b, s)
  ans3 <- list(beta = ans2[1], sigma = ans2[2])
  return(ans3)
}
#----------------------------
#MME beta estimator (separate)
MMEbeta <- function(x) {
  n <- length(x)
  x <- sort(x)
  mu1 <- mean(x)
  mu2 <- mean(x^2)
  b <- 2*(mu2 - mu1^2)/(mu2 - 2*mu1^2)
  #b <- 2*(mu1 - mu1^2)/(mu2 - 2*mu2^2)
  #b <- 2 * (mu2 - mu1 ^ 2) / (mu2 - 2 * mu1 ^ 2)
  ans2 <- b
  return(ans2)
}
#----------------------------
#MME sigma estimate (separate)
MMEsigma <- function(x) {
  n <- length(x)
  x <- sort(x)
  mu1 <- mean(x)
  mu2 <- mean(x^2)
  b <- 2*(mu2 - mu1^2)/(mu2 - 2*mu1^2)
  s <- mu1*(b-1)
  ans2 <- s
  return(ans2)
}
#----------------------------
#MLE.b: Bias correction Method of moments estimator
MME.b <- function(x, B = 100) {
  n <- length(x)
  x <- sort(x)
  bstar <- numeric(B)
  sstar <- numeric(B)
  P <- matrix(0,ncol=n,nrow=B)
  bb <- 1
  while(bb<=B){
    j <- sample(1:n,n,replace=TRUE)
    Xstar <- x[j]
    CV.flag <-  (sqrt((n - 1)/n)*sd(Xstar)/mean(Xstar) < 1) # Check for existence of estimator
    if(!CV.flag){
      bstar[bb] <- MMEbeta(Xstar)
      sstar[bb] <- MMEsigma(Xstar)
      j <- factor(j, levels=1:n)
      P[bb,]<-table(j)/n
      bb<- bb + 1
    }
  }
  Pbar <- apply(P,2,mean)
  mutilde1 <- sum(Pbar*x)
  mutilde2 <- sum(Pbar*x^2)
  btilde <- 2*(mutilde2 - mutilde1^2)/(mutilde2 - 2*mutilde1^2)
  stilde <- mutilde1*(btilde-1)
  scor <-MMEsigma(x) - mean(sstar) + stilde
  bcor <-MMEbeta(x)  - mean(bstar) + btilde
  ans3 <- list(beta = bcor, sigma = scor)
  return(ans3)
}


#----------------------------
#L-moments estimator:
#--------------------------------------------------
#Hosking, J. R. M. (1990). L-moments: Analysis and estimation of distributions using linear combinations of order statistics. Journal of the Royal Statistical Society. Series B (Methodological), 52, 105-124.
#----------------------------
l2 = function(X) {
  n <- length(X)
  X <- sort(X)
  nchoose2 <- choose(n, 2)
  j <- sequence(1:n)
  i <- rep(1:n, 1:n)
  Answer <- sum(X[i] - X[j]) / (2 * nchoose2)
  return(Answer)
}
#LME: The individual \hat{\beta} function
betahat.L <- function(x) {
  L2 <- l2(x)
  L1 <- mean(x)
  answer <- L2 / (2 * L2 - L1)
  return(answer)
}
#----------------------------
#LME: The individual \hat{\sigma} function
sigmahat.L <- function(x) {
  L2 <- l2(x)
  L1 <- mean(x)
  answer <- (L1 ^ 2 - L1 * L2) / (2 * L2 - L1)
  return(answer)
}
#----------------------------
#The L-moment estimator function:
LME <- function(x) {
  L2 <- l2(x)
  L1 <- mean(x)
  bhat.L <- L2 / (2 * L2 - L1)
  shat.L <- (L1 ^ 2 - L1 * L2) / (2 * L2 - L1)
  ans3 <- list(beta = bhat.L, sigma = shat.L)
  return(ans3)
}
#--------------------------------------------------
#Minimum Distance Estimator (CvM)
MDE.CvM <- function(x) {
  n <- length(x)
  x <- sort(x)
  MD.CvM <- function(param) {
    beta <- param[1]
    sigma <- param[2]
    ans1 <-   1/(12*n) + sum((pLomax(x,beta,sigma)-(2*(1:n)-1)/(2*n))^2)
    return(ans1)
  }
  lme <- LME(x)
  b <- lme$beta
  s <- lme$sigma
  ans2 <- optim(c(b, s), MD.CvM, method = "BFGS")
  ans3 <- list(beta=ans2$par[1],sigma=ans2$par[2],convergence=ans2$convergence)
  return(ans3)
}
#----------------------------
#MDE.SD/MDE.LS: Minimum Distance Estimator (LS or SD in the paper)
MDE.LS <- function(x) {
  n <- length(x)
  x <- sort(x)
  MD.LS <- function(param) {
    beta <- param[1]
    sigma <- param[2]
    ans2 <- (1 / n) * sum((pLomax(x, beta, sigma) - (1:n) / (n + 1)) ^ 2)
    return(ans2)
  }
  lme <- LME(x)
  b <- lme$beta
  s <- lme$sigma
  ans2 <- optim(c(b, s), MD.LS, method = "BFGS")
  ans3 <- list(beta=ans2$par[1],sigma=ans2$par[2],convergence=ans2$convergence)
  return(ans3)
}
#----------------------------
#MDE.KL: Minimum Distance Estimator (Phi=KL)
MDE.Phi.kl <- function(x) {
  n <- length(x)
  x <- sort(x)
  MD.Phi.kl <- function(param) {
    beta <- param[1]
    sigma <- param[2]
    fh <- density(x)
    fhat <- approxfun(fh$x, fh$y)
    fdg <- dLomax(x, beta, sigma) / fhat(x)
    mean(phi.kl(fdg))
  }
  lme <- LME(x)
  b <- lme$beta
  s <- lme$sigma
  ans2 <- optim(c(b, s), MD.Phi.kl, method = "Nelder-Mead")
  ans3 <- list(beta = ans2$par[1], sigma = ans2$par[2], convergence=ans2$convergence)
  return(ans3)
}
#----------------------------
#MDE.chisq: Minimum Distance Estimator (Phi=ChiSq)
MDE.Phi.chisq <- function(x) {
  n <- length(x)
  x <- sort(x)
  MD.Phi.chisq <- function(param) {
    beta <- param[1]
    sigma <- param[2]
    fh <- density(x)
    fhat <- approxfun(fh$x, fh$y)
    fdg <- dLomax(x, beta, sigma) / fhat(x)
    gdf <- fdg ^ (-1)
    mean(gdf * phi.chisq(fdg))
  }
  lme <- LME(x)
  b <- lme$beta
  s <- lme$sigma
  ans2 <- optim(c(b, s), MD.Phi.chisq, method = "Nelder-Mead")
  ans3 <- list(beta = ans2$par[1], sigma = ans2$par[2], convergence=ans2$convergence)
  return(ans3)
}
#----------------------------
#MDE.TV: Minimum Distance Estimator (Phi=Total Variation)
MDE.Phi.tv <- function(x) {
  n <- length(x)
  x <- sort(x)
  MD.Phi.tv <- function(param) {
    beta <- param[1]
    sigma <- param[2]
    fh <- density(x)
    fhat <- approxfun(fh$x, fh$y)
    fdg <- dLomax(x, beta, sigma) / fhat(x)
    gdf <- fdg ^ (-1)
    mean(gdf * phi.tv(fdg))
  }
  lme <- LME(x)
  b <- lme$beta
  s <- lme$sigma
  ans2 <- optim(c(b, s), MD.Phi.tv, method = "Nelder-Mead")
  ans3 <- list(beta = ans2$par[1], sigma = ans2$par[2], convergence=ans2$convergence)
  return(ans3)
}
#----------------------------------------------------
#MLE: Maximum Likelihood Estimator
MLE <- function(x){
  ans <- flomax(x)
  ans3 <- list(beta = as.numeric(ans[[1]][1]), sigma = as.numeric(ans[[1]][2]), returnCode = as.numeric(!ans$cvg))
  return(ans3)
}
#----------------------------
#Bias Adjusted Maximum Likelihood Estimator
MLE.b <- function(x, ruleofthumb = TRUE) {
  n <- length(x)
  x <- sort(x)
  mle <- MLE(x)
  b <- mle$beta
  s <- mle$sigma
  #D <- as.numeric(151 <= n & n <= 500)
  D <- as.numeric(151 <= n)
  bstar <-
    -0.991404 + 0.027773 * n - 0.0000328 * n ^ 2 + 0.64541 * log(n) - 3.617656 *
    D - 0.014898 * D * n + 0.0000293 * D * n ^ 2 + 1.036946 * D * log(n)
  if (b < bstar & ruleofthumb == TRUE) {
    K <- n*matrix(c(b/((b + 2)*s^2),
                    -1/((b + 1)*s),
                    -1/((b+1) * s),
                    1/b^2), ncol = 2)
    A <- n*matrix(c(2*b/((b+2)*(b+3)*s^3),
                    -1/((b+1)*(b+2)*s^2),
                    b/((s^2)*((b+2)^2)),
                    -1/(s*(b+1)^2),
                    -1/((s^2)*(b+1)*(b+2)),
                    0,
                    -1/(s*(b+1)^2),
                    1/b^3),
                  byrow = TRUE,
                  ncol = 4)
    ans <-c(mle$sigma, mle$beta)-as.vector(solve(K)%*%A%*%as.vector(solve(K)))
  } else{
    ans <- c(mle$sigma, mle$beta)
  }
  return(list(beta = ans[2], sigma = ans[1]))
}
#----------------------------
#PWM: functions for the PWME
M1u0 = function(X, u) {
  #u can ONLY be 0 or 1
  n <- length(X)
  X <- sort(X)
  i <- 1:n
  Answer <- mean(X * ((i - 1) / (n - 1)) ^ u)
  return(Answer)
}
#----------------------------
M10v = function(X, v) {
  #v can ONLY be 0 or 1
  n <- length(X)
  X <- sort(X)
  i <- 1:n
  Answer <- mean(X * (1 - ((i - 1) / (n - 1))) ^ v)
  return(Answer)
}
#----------------------------
betahat.PWM <- function(x) {
  M100 <- M10v(x, 0)
  M101 <- M10v(x, 1)
  answer <- (2 * M101 - M100) / (4 * M101 - M100)
  return(answer)
}
#----------------------------
sigmahat.PWM <- function(x) {
  M100 <- M10v(x, 0)
  M101 <- M10v(x, 1)
  answer <- (2 * M100 * M101) / (M100 - 4 * M101)
  return(answer)
}
#----------------------------
PWM <- function(x) {
  n <- length(x)
  x <- sort(x)
  bb <- betahat.PWM(x)
  ss <- sigmahat.PWM(x)
  return(list(beta = bb, sigma = ss))
}
#--------------------------------------
#Airborne Communication Transciever Data
aircomtra<- c(0.2, 0.3, 0.5, 0.5, 0.5, 0.5, 0.6, 0.6 ,0.7 ,0.7 ,0.7 ,0.8,
              0.8, 1.0, 1.0, 1.0, 1.0, 1.1, 1.3, 1.5 ,1.5 ,1.5 ,1.5 ,2.0,
              2.0, 2.2, 2.5, 2.7, 3.0, 3.0, 3.3, 3.3 ,4.0 ,4.0 ,4.5 ,4.7,
              5.0, 5.4, 5.4, 7.0, 7.5, 8.8, 9.0, 10.3, 22.0, 24.5)


#Fitres_w.txt
Fitres_w <-c(1.485381673, 0.165038112, 2.006758892, 2.292668855, 2.635752334,
             0.264005383, 0.335178332, 0.933782372, 2.655554829, 0.665884419,
             0.39405991, 1.01689498, 0.617685598, 1.449129493, 0.321980049,
             0.513483043, 1.944080099, 0.098871614, 0.300503275, 0.251320558,
             1.34757921, 0.82043082, 0.371508133, 1.342510511, 0.353733192,
             1.395923741, 1.242986936, 1.6652756, 2.54323713, 0.254554137,
             0.174095563, 0.175021465, 1.14394073, 0.603627415, 0.429541935,
             0.357315837, 0.123491788, 0.2040226, 3.279883116, 0.376632595,
             2.660742824, 3.907976784, 0.647809248, 0.079261559, 4.114109802,
             0.884023927, 2.678296289, 2.954728405, 0.176908512, 0.194897097,
             0.552379791, 0.338625885, 4.164839343, 0.921127349, 0.854464977,
             0.705048935, 0.15202554, 0.342016755, 0.237466265, 0.351571969,
             1.920124339, 1.009987029, 1.28900211, 2.482512814, 2.299468078,
             0.182467093, 0.059061502, 1.743786434, 1.534125318, 2.297185579,
             0.503758469, 0.224679715, 0.453919298, 2.771755199, 1.020438337,
             0.913149588, 0.695267217, 1.987498761, 0.149534838, 0.147812358,
             1.277784206, 0.39698945, 0.020176403, 1.095411188, 0.767832568,
             0.319713534, 0.416364242, 0.353290243, 0.840374559, 0.264378551,
             0.961151487, 0.55883268, 2.684775453, 4.533873623, 1.610772283,
             1.341179335, 1.312620053, 0.63689705, 0.1743658, 0.139447287,
             0.453029144, 0.783924992, 2.685326565, 0.065115055, 2.011705897,
             0.422458618, 1.195362573, 2.997751346, 1.953115606, 2.011895501,
             0.935241396, 0.322737373, 0.41180323, 8.375782044, 2.806461969,
             0.658759303, 3.402708832, 0.023093722, 0.671681519, 0.335719457,
             0.320890341, 0.165262419, 0.071697962, 0.202558031, 0.349990859,
             0.243441082, 0.730199743, 1.641592102, 1.758438312, 0.230536002,
             1.160960289, 1.061267039, 0.831385536, 1.724632413, 1.281126754,
             1.080961622, 0.443230472, 4.05786998, 0.138694223, 0.245907018,
             0.909459171, 0.201677511, 0.086234658, 0.558901388, 1.693584496,
             0.981738763, 0.262837856, 2.607775204, 0.170405602, 0.193866561,
             0.371117814, 2.408676679, 0.165053556, 0.964318065, 1.233169532,
             0.078176949, 0.575602054, 0.051244341, 0.223037467, 0.660689555,
             0.167208468, 0.104148873, 0.422615954, 0.230799311, 0.044403114,
             1.002814827, 0.731290184, 0.569147524, 5.093803382, 0.830261067,
             1.737307862, 0.723301576, 0.421668896, 0.258639607, 0.430027707,
             0.156607967, 0.867412312, 0.526168755, 1.056534715, 1.641136412,
             0.262059455, 3.705339292, 1.84055366, 0.119862875, 1.555652817,
             0.495115954, 0.252488204, 1.287152112, 0.74790811, 0.262689432,
             0.659152264, 0.554266044, 2.118470629, 0.936384601, 1.715006933,
             2.227475595, 0.854714715, 0.577033186, 0.227779765, 0.403053996,
             0.901583924, 0.583952208, 0.989140683, 0.85438299, 1.06175074,
             1.670915116, 1.926323047, 5.166332094, 1.207995998, 1.785687473,
             0.250062304, 0.165300169, 0.679393296, 0.325268953, 0.748793609,
             0.067856117, 0.540579558, 0.06655233, 0.624336464, 0.631763557,
             1.395169233, 2.679705794, 0.948142085, 1.157279014, 0.367297747,
             0.252238475, 0.269816719, 1.019139076, 1.912179268, 0.164685889,
             0.752952824, 4.139663178, 0.933891379, 0.240824226, 0.860407202,
             0.411664052, 1.273898482, 2.700339966, 2.739139704, 3.123115591,
             0.191205342, 2.222383898, 1.478962498, 0.712869216, 0.193071087,
             1.824796676, 0.14113953, 0.249320533, 0.241188249, 1.566751139,
             0.541807203, 1.254102983, 0.531444369, 0.161657622, 0.988840901,
             1.798427177, 1.251326056, 0.189339215, 0.79535208, 1.095198492,
             1.344479063, 0.42954599, 1.268114345, 0.401766039, 1.314750101,
             0.748404682, 0.222698783, 0.213798238, 1.350528986, 0.504616572,
             0.433523336, 1.404501123, 0.118817899, 2.714734481, 0.451926119,
             1.900610123, 1.4231783, 0.153850321, 0.527453367, 0.57444032,
             2.268387689, 0.506544091, 3.279714034, 1.409764158, 0.805821966,
             2.47921344, 1.813986472, 1.707998251, 2.093577705, 0.845072151,
             0.588069114, 0.571850533, 2.28164421, 0.442150387, 0.264227647,
             0.114485867, 0.71039663, 1.789026089, 1.651031487, 2.15238055,
             0.631568627, 6.091136648, 0.190144379, 1.805957286, 0.243095413,
             0.206230435, 0.857211061, 0.41140422, 0.212711719, 0.835218778,
             0.894731857, 0.208869456, 0.896812769, 1.007790794, 0.813298265,
             2.042101891, 0.665219466, 0.601588653, 1.230080357, 0.70892906,
             0.105853668, 0.757997695, 1.186196032, 0.81503706, 0.299274783,
             0.226124412, 0.692722143, 0.391534361, 0.642806687, 0.106784243,
             1.042741402, 0.275245214, 0.31059372, 1.067031545, 2.142124649,
             0.478578549, 1.019988182, 0.213736907, 0.363858456, 0.468535453,
             2.080507038, 5.78664204, 0.275921847, 0.221114196, 0.110790741,
             0.46439944, 1.276508942, 2.150119114, 0.98153634, 0.319274621,
             0.815843284, 0.627883254, 0.525094965, 2.485222235, 2.792478157,
             2.05664619, 1.21633839, 0.195981181, 0.568681154, 1.443391888,
             1.054858836, 0.115636286, 0.572788965, 0.290669427, 0.688689904,
             1.359898715, 0.412632759, 0.489352682, 0.262825445, 0.500612128,
             2.434504703, 0.849713377, 0.956889132, 2.695625803, 0.386943598,
             3.567751176, 0.654644011, 1.067199935, 6.176033678, 0.23002023,
             0.115510078, 0.913654773, 0.466408869, 0.679378041, 0.430634947,
             0.028360266, 1.419298442, 0.425349372, 0.43314892, 0.190328416,
             0.638336297, 0.569615377, 0.144316639, 0.829195759, 0.943871857,
             0.13610631, 0.041190637, 0.502600427, 0.524328067, 2.407917196,
             0.4837108, 0.449452912, 0.567858424, 0.271082848, 0.288751283,
             0.80670843, 1.929388363, 0.394471296, 1.453141484, 3.937080993,
             1.286067635, 0.493274025, 0.244493905, 2.085675818, 0.489266902,
             0.654545423, 1.268730862, 0.35431009, 0.952004374, 0.570690661,
             0.20238606, 0.283825924, 0.230853639, 1.018032583, 0.46262756,
             0.312219529, 0.861597067, 0.724838137, 0.839560222, 0.270993245,
             0.215905571, 0.222221933, 3.525789335, 0.681749137, 0.591124911,
             3.721832887, 0.367038871, 0.95706174, 0.709319336, 2.277530884,
             0.770193347, 0.637035152, 0.591077387, 0.510732568, 0.945669673,
             0.295572571, 0.391067659, 0.525165228, 2.839971045, 4.575259645,
             1.33772371, 0.884270847, 0.63502644, 0.453230883, 1.030225579,
             1.283985042, 0.876965035, 7.490571646, 0.454534333, 3.686676097,
             0.838389969, 0.172038235, 1.731604732, 1.500240152, 0.278963384,
             3.547833769, 1.843138344, 0.794422341, 3.646755418, 1.343481348,
             0.93650935, 0.169694577, 0.361126095, 0.94745559, 0.334532147,
             1.002746937, 1.937117913, 1.691163693, 1.553674283, 1.009391345,
             0.334689613, 1.241182029, 0.342870491, 1.214237914, 1.383847392,
             2.184204669, 0.612475605, 2.590964529, 0.514323723, 0.181131571,
             1.194247026, 0.315117556, 0.645927269, 1.337247862, 1.946829056,
             0.717822174, 0.179441087, 3.84575611, 0.882694253, 0.2053879,
             0.156281854, 0.101972456, 0.501606891, 4.029675851, 0.256791674,
             3.823654532, 4.091988743, 0.223799021, 0.954106891, 0.119396459,
             0.015097935, 0.051956558, 0.056089827, 0.119879917, 0.317704045,
             0.16088721, 0.353142762, 0.584124042, 0.747092375, 1.078545379,
             0.513316213, 0.173133057, 0.288281888, 0.812290218, 0.462708327,
             0.08275686, 1.38388781, 0.95573468, 0.951971262, 0.192734663,
             1.902414604, 0.656126621, 0.30394276, 1.578677384, 0.205585356,
             0.062540085, 0.168023866, 0.291357121, 0.721957371, 0.657994796,
             0.124756427, 0.101124093, 2.517832354, 0.064165121, 0.313806298,
             1.309266828, 0.797778311, 0.726808424, 0.202368495, 1.553315664,
             0.455044548, 1.03419154, 0.896322392, 0.889097837, 0.060611758,
             1.085271523, 1.169216737, 1.448975328, 7.133745093, 1.229942253,
             0.942883849, 0.631072535, 0.376438478, 0.467199295, 0.129991555,
             0.371895242, 0.139615939, 0.395347397, 0.723213873, 0.25287153,
             0.358910007, 0.70304552, 0.331470244, 0.572078835, 0.318334423,
             1.309803967, 2.206099549, 0.845507424, 1.617147314, 0.940252378,
             2.47490175, 0.12080328, 0.336346866, 0.771552903, 0.608838263,
             0.22216803, 1.27140782, 0.127263701, 1.777406092, 3.529952741,
             0.433212803, 0.468479443, 0.736488089, 0.824974832, 0.328489215,
             0.169735133, 0.56328886, 0.270480387, 0.262110788, 1.362008356,
             0.524864566, 1.517715006, 0.482182035, 2.056962821, 0.210961678,
             0.957950214, 2.202426417, 1.534962295, 0.449059536, 0.388707616,
             1.38010679, 1.234099987, 0.075949341, 1.146809458, 0.143395949,
             0.115524704, 1.187979378, 0.085086921, 0.567804531, 0.148322495,
             6.987436558, 0.603187732, 0.825751915, 3.473988947, 1.668222867,
             0.399885538, 1.115690465, 0.947843802, 1.312614027, 0.166218272,
             0.33365423, 0.590228811, 0.476287832, 0.510427362, 0.627629016,
             0.17972408, 1.472946443, 0.83977494, 0.817219582, 3.577203129,
             2.560400874, 0.672115996, 1.205561826, 0.17885455, 0.893923948,
             2.057709614, 0.307168821, 1.199737844, 0.839228561, 1.787686081,
             0.55653917, 0.089837719, 1.71231899, 0.12993632, 1.407208101,
             0.619755422, 2.563645258, 4.250199533, 0.290097724, 1.531725896,
             0.148708637, 0.160574871, 0.811340054, 0.704291545, 1.522414653,
             0.794745022, 0.294113157, 2.544348435, 0.812276872, 2.980376969,
             0.692214537, 0.516595956, 0.629566833, 0.502307063, 0.216005267,
             0.281259496, 0.158614986, 0.39864917, 0.099902121, 3.222844858,
             2.485016577, 5.418459705, 0.400722182, 0.552615695, 0.202239384,
             1.019145364, 1.20768028, 1.735129362, 0.80180995, 1.204295262,
             1.659754202, 0.195517036, 0.52196155, 2.086597486, 3.817043394,
             0.889966496, 1.780675938, 1.964442119, 0.2041086, 1.370199508,
             0.475702724, 0.220761712, 0.985560507, 2.327136509, 0.216307759,
             0.858186146, 0.071156073, 1.220259434, 0.327608113, 0.356967668,
             0.462160117, 0.850621512, 0.57272603, 0.874576293, 0.275680945,
             0.76098347, 0.311093862, 0.262062944, 0.060311463, 0.18111451,
             0.661395686, 2.35184638, 0.462959376, 10.24665224, 0.810702934,
             6.392343757, 0.195326849, 0.859302626, 1.22325587, 0.832560695,
             0.130216345, 3.059573856, 1.198335421, 0.564010851, 0.390856992,
             0.14204598, 0.227542115, 0.432793729, 0.106893689, 0.580687925,
             0.466568539, 3.748196389, 0.14425325, 0.199933134, 0.80728602,
             0.541183999, 0.940806108, 1.252555551, 0.067135029, 0.046564085,
             0.733411507, 0.460796171, 0.522651367, 0.288119991, 0.72194749,
             0.246312732, 0.565856835, 0.812903532, 0.109943236, 0.525530879,
             0.144424451, 5.186792041, 0.946259429, 1.97339302, 0.18209937,
             0.763744736, 0.082697052, 2.362420262, 0.872458182, 0.578971185,
             2.18839531, 0.718870597, 3.571352452, 2.130363272, 2.710274521,
             0.030826584, 0.776929465, 0.534364198, 0.814649212, 2.675208814,
             0.08955003, 1.224344394, 1.768908571, 2.127936287, 0.10714285,
             5.000971144, 0.101230912, 0.07944838, 0.198540551, 0.211865368,
             2.045641262, 0.281163884, 0.203498777, 0.480571324, 0.636256573,
             1.598957197, 0.515245582, 0.431325492, 0.206427869, 0.068284395,
             0.070637954, 0.815096214, 2.131068354, 6.59135627, 0.059544641,
             0.648009376, 0.719872177, 2.010986064, 0.226235168, 0.984121413,
             0.193064452, 4.44631984, 0.515452206, 1.140522189, 0.475060743,
             1.322496242, 0.950248099, 0.295320692, 0.442059522, 0.535981835,
             0.724058469, 2.056915176, 1.036647509, 2.191641173, 1.074506392,
             0.438459464, 0.47116304, 1.842332037, 0.0667841, 0.591780971,
             0.444094137, 2.318300586, 0.340014017, 0.755304127, 1.676201318,
             0.705697766, 0.172265234, 0.859757914, 0.9545421, 2.685559479,
             0.703747922, 0.394374809, 0.063152265, 0.334950086, 0.069751701,
             1.447601852, 0.181791496, 0.361418551, 0.39845501, 0.637172643,
             1.347284187, 0.83436522, 1.504008719, 0.779525532, 1.15660868,
             2.133313172, 5.838243402, 0.468012877, 0.611934146, 0.354752294,
             0.953451485, 0.805928949, 1.129767783, 0.433259739, 0.557311701,
             0.580397587, 0.286215733, 0.304101577, 0.644531415, 1.285154283,
             0.700073781, 0.591311609, 2.031629985, 0.72648576, 0.926479112,
             0.172580967, 0.210438071, 1.010669364, 2.044136394, 2.87165104,
             0.586606009, 0.535377835, 1.653595552, 0.585174251, 0.972113926,
             2.018536502, 0.397545562, 0.294477958, 1.310583608, 0.461645292,
             0.733108915, 0.406623457, 0.817491946, 0.68293162, 1.148300704,
             1.688653087, 0.396084521, 5.002953087, 0.713086034, 3.683821723,
             0.973786715, 0.165781714, 0.495904896, 1.465666773, 1.194082619,
             1.568561585, 0.167789088, 1.272309121, 0.134345361, 1.956043135,
             2.483882886, 0.839222523, 0.484373909, 0.371260767, 2.343780333,
             1.475385868, 0.745820786, 1.653658286, 0.268509807, 1.048409051,
             0.289313402, 1.400277864, 1.602019165, 0.370429735, 1.208933973,
             3.739662389, 0.41377456, 0.273728004, 3.089812109, 1.738694851,
             0.122954351, 0.402409547, 0.89200402, 1.061864727, 0.356841689,
             1.010811775, 0.567771038, 1.641223242, 0.675462353, 0.342017134,
             0.195831705, 3.917852965, 0.087969183, 0.442551346, 0.408462582,
             1.063319841, 0.703367952, 0.249044131, 0.003399676, 0.895853514,
             0.325879537, 0.986438416, 0.70573981, 0.558193868, 0.17771507,
             0.605040603, 3.529436048, 1.504190027, 0.528260521, 3.961888309,
             1.485338648, 2.417703128, 1.065563177, 1.619257905, 0.353326192,
             3.262336163, 0.870278394, 0.34166452, 0.021127963, 0.44424203,
             4.990076444, 3.656380455, 0.637332893, 0.669852048, 0.593602939,
             2.946948179, 0.346727979, 1.172328735, 0.153259666, 0.359890419,
             0.102784831, 0.778290508, 1.304428913, 1.074339395, 0.580208972,
             0.59843099, 0.120914155, 0.398664262, 0.092069519, 1.53260424,
             0.445760131, 1.100069119, 0.759181088, 0.079583176, 1.433607121,
             0.457183317, 0.502780538, 0.637677797, 0.602287021, 0.791929486,
             1.984718033, 0.258082829, 0.371920611, 0.078759781, 0.20769847,
             0.200861974, 0.163114482, 0.248284693, 0.517843772, 0.48683749,
             2.808618221, 0.284325432, 1.688130393, 0.654056764, 2.623684175,
             0.71980481, 0.225783536, 5.704539468, 0.588991213, 1.072049315,
             1.118957362, 4.108698591, 0.037637536, 1.447500333, 3.441464722,
             2.771624927, 0.126704563, 1.814033318, 2.727962188, 0.258876232,
             0.080635892, 2.241358379, 2.319750677, 0.128984203, 0.852702974,
             1.496439094, 0.85958895, 0.872278654, 0.179088234, 0.645059756,
             1.107013561, 0.731224839, 0.046668308, 0.136562427, 0.027334785,
             0.589965635, 0.785307347, 0.561106959, 0.279612925, 0.323222378,
             0.072240445, 0.12071506, 2.320902266, 0.68716929, 0.389794917,
             1.834319056, 0.344774797, 0.402784027, 0.476309941, 0.083160196,
             0.209281511, 0.643168378, 3.80986893, 0.44659958, 0.599742935,
             2.77395501, 1.443291448, 0.212236724, 0.494006666, 2.615663487,
             2.314764645, 0.966976589, 0.670489871, 0.197355541, 0.531037552,
             0.727265809, 0.766577397, 1.208355976, 0.844225617, 0.633226761,
             0.438309927, 1.790636822, 0.23353645, 0.358509642, 4.430672776,
             1.408717487, 1.600471539, 0.10277927, 0.107001125, 0.708152486,
             0.330267886, 0.876953134, 0.378892251, 1.209437009, 0.908251833,
             1.036216127, 0.347290727, 0.939513144, 1.076564603, 1.189161865,
             0.954218595, 1.862435889, 2.591533041, 0.142144006, 0.121561272,
             0.841292815, 0.244102655, 0.275040832, 0.046564007, 0.192782476,
             0.452138253, 0.544771641, 1.155235619, 1.186571044, 0.868071451,
             1.505925431, 0.914557918, 0.300857616, 0.045652936, 0.509311317,
             0.105996013, 0.666736545, 1.409022928, 0.453026256, 0.237832725,
             0.253434066, 0.065547312, 0.62227402, 1.04791538, 0.996397944,
             0.320891913, 5.113070605, 0.926624071, 0.432642127, 0.202650677,
             4.274806195, 2.280901785, 0.582004893, 0.635909827, 3.586255189,
             2.01234487, 0.77423954, 1.216918893, 1.487580757, 0.930925369,
             0.970046126, 3.330606459, 0.821554779, 1.318615098, 1.920337254,
             0.344477634, 0.171651771, 0.261646638, 0.133415637, 0.079151009,
             0.456091122, 0.163029943, 1.084600328, 0.136467177, 0.16013772,
             0.172389509, 0.644665405, 0.280808576, 0.091183665, 1.335510294,
             0.728330673, 0.217206883, 0.0386537, 1.394725402, 1.719322784,
             0.600100216, 0.555098885, 1.084249892, 0.062895373, 0.420514251,
             0.183219791, 0.208811677, 0.277956983, 0.352585421, 0.400638962,
             0.305493706, 6.646196917, 0.535485493, 0.482055297, 0.451155919,
             3.638108281, 0.592316001, 1.734016645, 0.699998979, 0.569957636,
             1.162327427, 0.114968444, 1.340613105, 0.195625703, 0.255646887,
             4.556799027, 1.057831708, 1.288649316, 3.425108933, 1.878381562,
             1.616505832, 0.785643836, 1.639973908, 0.291847728, 0.991457944,
             0.199528415, 0.299617357, 0.550921371, 0.241274431, 0.276779758,
             0.203078075, 0.832075094, 0.26894295, 0.476596672, 0.558860121,
             0.487991284, 4.22257022, 3.731433377, 2.33202717, 0.53328277,
             1.139537616, 2.034551382, 4.66349932, 0.105243233, 2.447569088,
             0.366605043, 0.578922715, 2.682774522, 0.625692074, 0.78803058,
             0.798170968, 0.59645019, 0.357782039, 1.048920545, 0.614181074,
             1.544833179, 0.756171046, 1.491327084, 0.284639971, 1.405045638,
             2.384772093, 0.126525247, 0.399258997, 0.380222271, 0.328553817,
             0.137758715, 0.185520577, 0.117694396, 0.526068245, 0.628350577,
             0.68593179, 7.320471123, 5.030450715, 0.432753622, 0.172471058,
             0.650690528, 1.10148843, 1.114164411, 0.094222947, 0.03642397,
             0.121906404, 0.086186053, 0.486114267, 2.273394202, 0.171427137,
             0.11042672, 0.211686511, 3.491345835, 0.562859761, 7.375795203,
             0.269868148, 1.830860427, 0.518055539, 3.598433009, 0.399259193,
             0.440029715, 0.057421833, 0.219435065, 0.530093492, 1.549676435,
             0.045228737, 0.847047358, 0.139347267, 0.211916234, 0.166356073,
             0.207734283, 0.111527034, 0.049417007, 1.225202108, 0.610917687,
             1.596833309, 3.800781252, 1.535326456, 0.463932337, 1.644267785,
             2.171583983, 0.779285117, 0.161955433, 0.569942437, 0.373584915,
             1.143410847, 0.577666218, 1.373881324, 3.311277585, 4.109905943,
             0.447305727, 0.099081653, 0.12901739, 0.22202806, 0.16774012,
             0.238090155, 0.051005144, 0.478096764, 0.628273405, 1.178515284,
             0.788963529, 0.47887566, 0.356349508, 0.346258802, 0.603367164,
             1.142452535, 1.906559628, 3.261488467, 3.372536833, 0.084648051,
             0.804196042, 1.375478875, 0.087288499, 0.645772262, 0.1819884,
             2.480016885, 0.758260199, 0.567407552, 2.057244573, 0.758949703,
             0.683290972, 0.353037381, 0.485702507, 1.587665434, 0.815264296,
             0.839106565, 0.757715758, 0.133521535, 0.7693177, 0.370513627,
             0.322776299, 1.007632955, 0.028572356, 0.831069114, 0.271950631,
             1.29184086, 0.718490429, 0.539559632, 0.235241484, 0.745665911,
             0.971313087, 0.701089035, 1.553509094, 0.175833897, 0.253920887,
             1.433999403, 2.397373547, 1.66699302, 1.514763772, 1.221769542,
             1.659193521, 0.308735012, 0.781542674, 3.169791223, 0.378828132,
             0.22709494, 0.884472879, 0.258372665, 1.38545972, 1.419220591,
             0.886746926, 0.632959124, 2.200659556, 0.368133938, 0.304162741,
             3.133481125, 0.262909079, 0.588833463, 0.265889433, 3.232312447,
             0.629170247, 0.180483063, 0.577401124, 0.395492725, 6.26404464,
             1.937236693, 2.293506971, 0.640780132, 0.496013366, 0.848660857,
             0.107927646, 0.092845698, 0.021914186, 0.114926454, 0.129558784,
             0.089558121, 0.774326005, 0.326804257, 0.733683446, 5.564166904,
             0.329029346, 0.092707211, 0.150763902, 0.22562272, 0.916723327,
             1.358419201, 0.388238054, 2.181869423, 0.443759615, 2.832442606,
             1.881859996, 2.84079232, 2.30538923, 0.584736242, 0.36201639,
             0.165749896, 0.067015394, 0.315918304, 0.201835196, 0.815252817,
             0.839222465, 1.485065773, 0.300156518, 6.523088969, 0.899925944,
             1.038371134, 0.290854909, 1.387216676, 1.208170353, 0.676140125,
             0.574780488, 0.4053252, 1.340291844, 2.91764859, 2.08675091,
             0.293715613, 0.712235571, 0.461539322, 0.738642353, 2.17733566,
             0.055318039, 2.325292149, 0.463234648, 0.166325659, 0.509580507,
             0.76900606, 1.898642774, 0.034146601, 0.074177239, 5.103734981,
             1.773576561, 0.422608092, 1.223203308, 1.701466498, 2.185025669,
             0.128619444, 1.043707091, 2.875256635, 0.525500303, 0.478033165,
             0.509595596, 0.811762669, 3.658984132, 0.252967288, 0.123050193,
             0.839886864, 3.767794969, 0.439705128, 0.413965636, 2.412986604,
             2.095628301, 0.174186373, 0.835921143, 2.276135326, 1.069199358,
             0.712485932, 2.363946405, 0.438861115, 0.5757839, 0.387861107,
             0.772270037, 1.668184085, 0.611765313, 0.752479819, 0.184467795,
             0.206274451, 1.354785453, 1.016474226, 0.582811666, 1.054912575,
             0.376312098, 0.62466823, 0.507029714, 2.895433843, 0.377852243,
             0.291312481, 1.33887726, 0.474863919, 0.354254928, 0.646760779,
             0.598735789, 0.016879205, 0.01232014, 0.06968922, 1.603902715,
             0.649889446, 1.428062887, 2.976596008, 0.322740769, 0.148274227,
             0.066376165, 0.555028929, 0.81844068, 0.094448006, 0.687599425,
             0.634092106, 1.89825493, 1.532824533, 0.421685123, 3.472007074,
             7.193465935, 0.517470757, 2.981427195, 0.13217576, 0.092667511,
             0.133621518, 0.120210141, 0.37901214, 1.548814651, 0.704010603,
             0.096569634, 0.212688279, 0.59106706, 1.122353599, 1.022880448,
             1.076229542, 0.14583359, 0.110722881, 0.156892456, 0.054731414,
             1.224413524, 0.643790673, 0.250125936, 0.206928485, 1.617360392,
             1.084623751, 0.324182006, 0.073602206, 1.484090065, 0.699366719,
             0.991814749, 0.772043648, 1.119087563, 0.216394623, 0.697154135,
             0.250051006, 0.412728638, 1.046646318, 0.441968886, 0.369611646,
             1.621591578, 1.591390614, 0.528144747, 1.685137057, 0.612149823,
             2.666522951, 1.528341846, 0.854417211, 0.922420627, 0.227427584,
             0.858417887, 1.829104933, 6.986298701, 0.995361768, 1.420734469,
             2.493682903, 0.085533348, 0.013285944, 0.683378334, 1.667734703,
             0.634917992, 0.986360109, 0.108091913, 0.872771667, 2.466206128,
             2.197060692, 0.306943443, 2.54096345, 0.107565418, 0.228378123,
             0.397268815, 2.540840656, 0.6688682, 1.633269243, 1.884991917,
             0.501828449, 1.807044425, 0.281478742, 0.336458857, 0.371028577,
             0.399982211, 1.127749715, 0.308002442, 0.191473934, 0.466343355,
             3.080547973, 1.358281859, 0.780583394, 3.555062488, 0.674476686,
             0.588693062, 1.55054171, 0.189597697, 1.352115501, 0.15032394,
             0.230663271, 0.191536493, 0.198502144, 3.515801421, 0.130135601,
             0.837515721, 1.16307411, 1.137590384, 0.165282342, 0.483518956,
             0.307176442, 0.065962711, 0.439564446, 4.225659528, 0.432796602,
             2.462102295, 0.178617477, 0.065478435, 0.306673089, 0.287021766,
             0.289949676, 0.821474381, 2.837470992, 2.307140556, 0.885459644,
             7.781807875, 0.595300433, 2.340329598, 0.082755549, 0.058780008,
             1.13457512, 1.777649587, 0.43814455, 0.526754987, 0.523516854,
             0.37567767, 0.906813414, 1.295930484, 1.72900657, 2.709610685,
             0.1210926, 0.523295767, 0.851134406, 0.150169302, 0.075764889,
             0.176710396, 0.006346854, 0.083377765, 2.915786337, 2.446164439,
             0.242850411, 0.637763269, 1.007911159, 0.958890394, 0.315791935,
             1.786271556, 0.192503817, 0.650775232, 2.504999446, 0.504491169,
             0.393733015, 10.83878507, 2.805236511, 0.366095171, 0.039206648,
             0.191147558, 0.607329882, 0.8291464, 0.120956136, 0.20124381,
             0.174243962, 0.558631808, 2.468343697, 3.309279436, 0.635275605,
             1.859750209, 0.790040127, 0.270776083, 0.304869316, 0.192221134,
             2.394650369, 0.828751013, 2.272304358, 0.097357621, 2.124092828,
             0.465872083, 0.183211525, 0.142317287, 0.453476233, 0.91837963,
             0.335796362, 0.487492752, 0.376794729, 1.911053331, 4.20038516,
             0.199776245, 0.145974164, 0.28886925, 2.364550159, 0.897428749,
             0.370846204, 0.773672557, 1.427461413, 1.120988376, 0.899310433,
             0.465269177, 0.385687542, 0.223382524, 1.51565082, 2.003258438,
             0.645675758, 1.141780971, 0.92644324, 0.948347622, 0.901432362,
             0.645177372, 0.361479698, 2.143304959, 0.836425725, 1.454650299,
             0.252070711, 0.091645508, 0.060854736, 0.289258605, 0.276066841,
             0.116374242, 0.199989597, 0.257941016, 2.246261669, 1.139372466,
             1.512143898, 0.847179642, 4.616550878, 0.630385258, 0.514903351,
             1.919777588, 1.234990961, 3.035854272, 0.376313482, 0.658964383,
             1.207470795, 0.451136958, 2.065742284, 0.255579059, 1.402781843,
             0.033647964, 1.302098171, 0.882650641, 1.151018413, 0.698127453,
             0.109693575, 1.983908452, 1.114423954, 0.671350656, 1.326117503,
             1.070859018, 0.233147221, 0.409551815, 1.348741259, 2.681811633,
             1.462993646, 0.926241593, 0.682817337, 0.610808699, 1.360890328,
             0.334439357, 1.419334659, 1.258922228, 0.370000574, 0.051397018,
             1.221485432, 0.375723253, 0.19525113, 0.160135918, 0.733837036,
             1.531532065, 4.048514901, 2.771179129, 3.945751992, 1.983329477,
             1.023987075, 0.189795927, 0.142666494, 0.689771638, 2.172021997,
             0.596028278, 2.313477524, 0.047656193, 0.338601448, 0.201793079,
             0.220188489, 0.559699529, 0.095887641, 0.21224926, 2.900648495,
             0.597907943, 3.329376889, 0.685580317, 0.298145641, 2.603174219,
             0.46993559, 0.175074883, 0.644087409, 0.438052153, 1.357302297,
             0.132408337, 0.098578896, 0.048661718, 5.647684441, 0.10593236,
             1.325804256, 2.012477203, 0.074107813, 0.111028816, 0.043819634,
             0.089714727, 0.27945946, 0.083192496, 0.128032414, 3.56291166,
             3.477861672, 1.275925339, 1.925240113, 2.243174291, 0.037931842,
             1.250466046, 0.787428188, 0.534190741, 0.142932758, 0.274405326,
             0.648002103, 0.244869671, 0.567416073, 11.87272033, 0.633102222,
             0.719338893, 0.399441162, 1.427979884, 7.845590934, 0.042430227,
             0.394169322, 0.354743986, 2.334312168, 0.082360743, 0.017968442,
             0.7630782, 2.828264858, 0.188276587, 0.243693672, 0.112732687,
             0.784319997, 0.744617416, 0.499330782, 0.528246541, 0.886944674,
             0.074750524, 0.048897448, 0.059361048, 1.029815139, 0.465294185,
             0.451327281, 0.972883681, 0.640028325, 1.737426828, 0.609688664,
             0.837991752, 0.391533501, 0.931749143, 1.073139761, 1.864137274,
             1.650888482, 2.461368898, 1.159555118, 0.827247121, 3.298258936,
             4.111636801, 1.563093576, 2.279509389, 10.02671098, 0.237540584,
             5.218583345, 0.739365127, 0.259309668, 0.041771507, 0.136289273,
             0.123382233, 1.223642574, 0.176100872, 0.190541788, 0.231575224,
             0.251675524, 0.082951479, 0.248812348, 0.174112786, 0.262917169,
             0.213463127, 0.035915758, 0.082591309, 0.090009617, 0.032665203,
             0.112353396, 2.680666844, 0.163740518, 0.470278012, 0.371427433,
             5.695104783, 0.566414421, 0.36437392, 0.173271956, 0.651434962,
             0.665458264, 0.296010902, 0.637311126, 0.150530281, 0.117988878,
             0.875761768, 0.493521802, 0.152727606, 4.054778092, 1.144836446,
             0.955290287, 2.244169293, 1.615566258, 1.866824822, 0.360794002,
             1.129899726, 0.428538135, 3.320627495, 1.405793974, 1.475873958,
             0.154646332, 0.213944175, 0.064966411, 0.062597082, 0.645526133,
             1.100598664, 6.848676078, 0.337581692, 0.735934598, 0.367879548,
             0.130053064, 1.277643984, 0.806748958, 0.806855676, 1.919528865,
             4.362498053, 0.574834598, 0.257259181, 0.838895556, 2.215588282,
             0.924747869, 0.527796707, 1.498414432, 0.279383411, 0.132850104,
             0.126085961, 0.097723614, 0.473001752, 0.305165175, 0.13594157,
             2.787837003, 0.410920739, 0.845248216, 1.153645168, 0.849808285,
             1.060522332, 1.952619405, 0.523498906, 1.124941107, 1.398926723,
             2.487344765, 0.520696923, 0.587859891, 1.068939256, 0.374053857,
             1.387756862, 0.540505618, 0.866882865, 0.837132433, 0.321122833,
             1.598576848, 0.105075319, 0.488489958, 0.656308739, 0.818239396,
             0.865949921, 2.137158131, 0.276237474, 0.503758326, 0.613722514,
             0.255147993, 0.185011722, 0.129426779, 0.209954083, 0.558844188,
             0.057428142, 0.131150009, 0.215660349, 0.735797234, 1.065293799,
             0.319074685, 0.313568814, 1.68050098, 0.503857282, 0.564991845,
             0.869104638, 2.202654881, 3.252222426, 1.699015164, 0.39029566,
             1.152681644, 2.769480438, 5.366203178, 0.885571228, 0.649427949,
             0.750007305, 0.266422584, 8.248866513, 0.670037582, 0.416623505,
             0.645766843, 0.053176271, 0.371271694, 1.830541615, 0.760436588,
             0.494990283, 0.462899393, 0.77729326, 0.372152356, 0.809866263,
             0.14686114, 1.158482387, 1.633931661, 0.479569623, 0.036446233,
             0.647450483, 1.211115548, 0.75301898, 1.185495711, 0.29419055,
             0.353129558, 3.040336111, 0.219690333, 0.251404683, 0.676010418,
             0.121873118, 0.191156129, 0.092032644, 1.048948375, 2.088701739,
             0.415811057, 1.819472254, 0.174599313, 2.654279535, 0.269857344,
             0.3930501, 3.202574439, 0.109769307, 0.167853252, 3.380565134,
             0.944195948, 0.848653625, 0.6818232, 1.190913547, 0.479681157,
             0.062736379, 2.261660766, 2.565250887, 0.468915327, 1.218776391,
             0.231148641, 0.364947545, 0.620895738, 0.363875986, 4.726147015,
             1.089283622, 0.122087699, 0.183088413, 0.656862518, 1.9485946,
             0.406690854, 0.504208026, 0.57904117, 0.909434174, 0.285880141,
             1.487247199, 1.627529045, 1.092527939, 0.396211341, 0.186584509,
             2.209296488, 0.620101036, 0.283420258, 0.313024634, 1.313974986,
             0.958004286, 0.50347868, 2.886712777, 2.840229196, 0.75854105,
             1.488450078, 0.13851932, 0.149750821, 0.534523507, 3.643959848,
             0.210729343, 0.154480466, 0.039913454, 0.01792111, 0.366604154,
             0.293701492, 0.993644949, 1.793113612, 0.17311673, 1.606114293,
             1.818619431, 2.717022919, 2.024652608, 1.835050334, 1.552216471,
             0.071474128, 0.292577503, 4.29332659, 1.711436612, 0.062288448,
             1.337139368, 0.281581477, 0.438279225, 1.990990433, 0.852394398,
             0.705146281, 1.928986157, 0.589952477, 0.972548103, 2.267432429,
             0.722351113, 0.152912999, 2.202975286, 0.73645335, 1.918958424,
             0.156583201, 0.69168018, 0.321153964, 3.3342547, 0.055148008,
             0.421508508, 0.379468905, 1.034919306, 0.280814019, 0.394681274,
             1.637676287, 0.317224664, 0.980603685, 1.554135264, 0.687776717,
             0.574993121, 3.303670317, 1.663420925, 2.30883805, 4.823159296,
             3.762286677, 0.38822552, 0.102118055, 0.661215504, 0.154580542,
             1.046690182, 0.822017914, 1.040450663, 0.198696769, 1.177103533,
             0.077210381, 0.839238097, 1.59252125, 0.402131688, 0.503169683,
             0.577061604, 0.150988207, 1.770610657, 2.165997475, 1.700239027,
             0.522428044, 0.846221935, 0.466325113, 2.201674532, 0.059319136,
             0.843094215, 0.327323848, 2.614640142, 0.216756579, 0.291543133,
             1.920644618, 1.511625018, 0.252691826, 1.30724898, 0.210802377,
             1.308136749, 0.654476352, 1.459737422, 0.823096721, 0.674918964,
             0.154859969, 1.460425576, 0.28709976, 0.677780391, 0.544796982,
             1.078835452, 0.833168215, 1.406432499, 0.931869371, 0.224136922,
             1.052374594, 3.527058106, 0.287074339, 0.599565693, 0.182567614,
             0.895447321, 0.295506867, 0.100503422, 1.323285532, 3.841191773,
             2.100076803, 0.801387893, 0.843083458, 0.114247228, 0.51710157,
             1.776470389, 0.606683308, 4.891846905, 0.052610271, 0.425810126,
             2.076849939, 3.134543335, 1.101400091, 0.71485912, 0.935249493,
             0.240322926, 2.442390685, 1.305024234, 0.15816542, 5.100168493,
             0.647692066, 0.740054594, 0.963431583, 0.394716536, 0.230063325,
             1.897165613, 1.677822753, 0.887128305, 0.043517553, 0.561010955,
             0.239424743, 0.134000514, 0.395313193, 6.49648252, 0.624209692,
             0.402992567, 0.81202154, 0.414798631, 1.020268348, 1.386136587,
             0.632946535, 0.500363108, 1.452613146, 0.542478711, 0.587064626,
             2.225814511, 0.903787873, 0.142263595, 0.868676799, 0.58889806,
             0.215151026, 0.175469717, 0.257964082, 0.051797733, 0.051841923,
             1.680663856, 0.1487571, 1.079374417, 2.469252494, 1.071956462,
             0.393747616, 0.367626025, 0.765830343, 0.025084415, 1.310617459,
             1.173993104, 0.470501739, 0.359425159, 0.137668888, 0.500340545,
             0.965590211, 0.496437452, 3.169666255, 0.771646218, 0.322440762,
             4.347847896, 0.356078728, 0.534728855, 4.345437819, 0.614286339,
             1.241349905, 0.647795333, 0.529753732, 0.690022299, 0.269234708,
             0.174793205, 0.063883207, 0.142642556, 1.437116818, 0.04087305,
             0.895912004, 0.125852839, 1.288469133, 3.004284058, 0.744543583,
             0.830249676, 0.115659543, 0.090457314, 0.135887006, 0.163188289,
             0.476016422, 0.106200514, 0.16175569, 0.666380787, 0.416962171,
             1.380995657, 2.644925844, 0.108034751, 0.687297679, 0.606916334,
             6.915558325, 0.518181122, 2.782149198, 2.434454619, 2.112531213,
             1.123703043, 0.318147297, 0.097356204, 0.098606937, 0.163334532,
             2.464992988, 0.254753476, 1.947168818, 3.784890637, 2.058807765,
             0.070221205, 0.670754433, 0.977816868, 2.071990776, 2.119151401,
             0.322406046, 1.595512939, 0.447103607, 0.753016786, 0.712251117,
             2.024765924, 0.583791059, 1.835452639, 0.10156527, 0.128790096,
             0.722612763, 1.130181381, 0.816875344, 0.311913193, 3.299843353,
             0.310515561, 1.326202262, 0.237712742, 0.061800669, 0.134748966,
             0.507311768, 1.317722115, 1.970042704, 5.360977936, 0.14484884,
             0.104546028, 0.098096915, 0.359093731, 1.125756163, 1.880257698,
             1.314949816, 0.795891358, 1.087655212, 1.958331935, 0.865927711,
             0.350580584, 0.381502041, 1.245059438, 0.159968317, 0.908991661,
             3.433502109, 0.361551404, 0.688310917, 4.915747424, 0.911436996,
             0.083899908, 0.376827497, 0.46891118, 0.069637458, 1.05023661,
             0.344321352, 1.96658373, 0.75504055, 0.058480252, 0.277060115,
             1.206066118, 1.815616039, 0.091278177, 0.828115948, 1.627632076,
             0.926485786, 1.368493682, 1.69730855, 0.189644819, 0.868855384,
             0.178346155, 2.085475778, 0.729865954, 0.604834097, 0.044559313,
             0.204050625, 0.093490928, 0.521287884, 1.88032536, 0.524950782,
             0.04002076, 1.330410255, 1.447252974, 0.488353475, 0.922313186,
             0.315019532, 0.75688751, 0.705677594, 1.191466338, 1.007448086,
             0.278442361, 1.081726741, 0.184817923, 0.694476106, 0.177717221,
             5.68022663, 4.462640131, 1.805854049, 5.60432586, 0.253537417,
             0.166071951, 0.415977267, 1.106016717, 0.468822514, 3.446484763,
             0.808721919, 0.214656403, 0.17373551, 2.319116352, 0.25148978,
             3.067312691, 3.08160433, 0.467974581, 0.882679505, 0.052874102,
             1.28053386, 0.483266799, 0.426131673, 0.841407615, 2.335167394,
             0.076894845, 0.617352844, 0.035888885, 0.818116998, 1.268574275,
             0.308082513, 0.047598279, 0.709096682, 0.775287305, 9.733546174,
             0.245106232, 0.597359792, 0.590668337, 0.13317097, 1.460019206,
             1.564934824, 1.544556632, 2.962521338, 0.328190582, 0.280895292,
             0.156453924, 0.083316493, 0.131774735, 0.158618913, 0.190116315,
             0.164680478, 0.238524966, 0.605182957, 1.305719034, 0.646671046,
             0.499214831, 0.06867122, 0.044843106, 0.464466196, 0.725470145,
             0.408488755, 0.933141572, 3.065634389, 1.286768274, 0.55035519,
             0.279738215, 0.040657828, 0.118161809, 0.111775402, 0.483341997,
             0.972610872, 0.305610492, 2.528084834, 0.290705875, 1.284282673,
             0.799332897, 0.839936406, 0.565635468, 0.4623328, 1.697427974,
             0.600423982, 0.14409102, 1.209644072, 0.409012836, 1.345378028,
             1.412860519, 0.757014102, 0.861164487, 4.932325778, 1.457958813,
             0.255636858, 2.230934105, 0.963614014, 0.36525333, 1.369485208,
             0.216182061, 1.469346114, 1.97249592, 0.718431842, 0.821345106,
             0.715028918, 1.08130199, 0.31986454, 0.244287493, 0.389333577,
             4.707785044, 0.154936971, 0.788018575, 0.61053438, 0.636051344,
             3.50366631, 1.043775327, 0.174628318, 0.308740076, 0.159612209,
             3.142821231, 0.525121929, 0.046522064, 2.344603268, 2.511673157,
             0.399230609, 0.396580367, 1.301126731, 2.25588757, 0.051023517,
             0.590744997, 0.202464461, 0.554024064, 2.621423035, 0.171137471,
             0.601088169, 0.23017723, 1.012911995, 0.144657418, 0.829438361,
             0.592941578, 0.418713304, 1.53274779, 1.026612395, 1.606408472,
             0.082755064, 0.183308682, 0.196855909, 0.480119325, 1.016996692,
             3.870736056, 2.045385658, 0.242083451, 0.474504437, 0.75665158,
             0.529719302, 0.044265785, 0.684678898, 0.151484255, 0.223336979,
             0.025781847, 1.163184038, 0.258639289, 0.399697723, 0.71144224,
             1.27341428, 0.166136746, 0.567613243, 0.183399416, 0.12121969,
             0.639948519, 3.431237821, 0.974158962, 0.331604786, 1.462076369,
             1.205010719, 0.930850526, 2.515907933, 3.215403567, 1.09489388,
             0.38638851, 1.93611897, 0.640305, 0.336156399, 0.199192821, 0.560759032,
             0.212440067, 2.068793234, 1.445042545, 0.471595055, 5.696211434,
             0.225677992, 0.333899134, 0.353627038, 0.602003743, 0.364288346,
             0.994527506, 1.137847981, 1.858992173, 0.070251109, 1.009836056,
             0.132674151, 0.388090109, 0.563764635, 1.029865043, 1.522100527,
             0.912591324, 0.653423903, 0.368683927, 0.317549864, 0.279742711,
             0.869961931, 1.628879935, 0.336817155, 1.7759316, 0.115561934,
             0.640044232, 0.61957966, 1.790503604, 2.049718703, 0.158642012,
             0.780268052, 0.359179897, 1.088349034, 0.921014092, 0.123668434,
             0.605705807, 0.197280609, 0.404526583, 1.132854761, 0.413681518,
             3.486556322, 0.687721821, 2.228158526, 0.195296818, 0.373513754,
             1.142270059, 0.486178922, 1.55724849, 1.08338348, 0.411349792,
             0.30753079, 0.184054875, 0.231183579, 0.184126247, 0.601721293,
             1.061264836, 0.521725078, 0.210060592, 0.752382038, 0.477981005,
             0.479724614, 3.025182987, 5.099219202, 0.196885738, 0.777239815,
             0.89765108, 0.399786121, 0.418628019, 0.188846467, 0.402843255,
             0.520457747, 0.205838772, 0.726668539, 0.241144846, 0.522891151,
             0.091919764, 0.548454409, 0.173028781, 0.336497959, 0.46284683,
             0.226208861, 0.935223329, 0.939146496, 0.479656376, 0.407924699,
             0.316239929, 1.51661279, 2.385857369, 0.29634043, 1.416014092,
             1.021728428, 0.859792114, 0.568595188, 0.363302269)



graphsnstuff <- function(x,B=1,PvalAIC="p",namex="x",printPDF=TRUE,xlimmax=5){
  tim<-format(Sys.time(), "%Y-%m-%d.%Hh%Mm%Ss")
  varnm<-deparse(substitute(x))
  tim <- paste0(varnm,".",tim)
  
  est <- list()
  
  est[[paste0("MLE",varnm)]]           <- MLEx           <- MLE(x)
  est[[paste0("MLE.b",varnm)]]         <- MLE.bx         <- MLE.b(x)
  est[[paste0("LME",varnm)]]           <- LMEx           <- LME(x)
  est[[paste0("MDE.CvM",varnm)]]       <- MDE.CvMx       <- MDE.CvM(x)
  est[[paste0("MDE.LS",varnm)]]        <- MDE.LSx        <- MDE.LS(x)
  est[[paste0("MDE.Phi.chisq",varnm)]] <- MDE.Phi.chisqx <- MDE.Phi.chisq(x)
  est[[paste0("MDE.Phi.tv",varnm)]]    <- MDE.Phi.tvx    <- MDE.Phi.tv(x)
  est[[paste0("MDE.Phi.kl",varnm)]]    <- MDE.Phi.klx    <- MDE.Phi.kl(x)
  est[[paste0("MME",varnm)]]           <- MMEx           <- MME(x)
  est[[paste0("PWM",varnm)]]           <- PWMx           <- PWM(x)
  
  EDF <- ecdf(x)
  
  
  #LOMAX
  KS.stat <- NULL
  KS.stat[1] <- max(abs(EDF(x) - pLomax(x,MLEx$beta,MLEx$sigma)))
  KS.stat[2] <- max(abs(EDF(x) - pLomax(x,MDE.LSx$beta,MDE.LSx$sigma)))
  
  #WEIBULL
  weib.est   <- eweibull(x)$parameters
  weib.shape <- weib.est["shape"]
  weib.scale <- weib.est["scale"]
  KS.stat[3] <- max(abs(EDF(x) - pweibull(x,shape=weib.shape,scale=weib.scale)))
  
  #GAMMA
  gamm.est   <- MASS::fitdistr(x, "gamma", start=list(shape=1, scale=1))$estimate
  gamm.shape <- gamm.est["shape"]
  gamm.scale <- gamm.est["scale"]
  KS.stat[4] <- max(abs(EDF(x) - pgamma(x,shape=gamm.shape,scale=gamm.scale)))
  
  if(tolower(PvalAIC)=="p"){
    
    b <- 1
    BS.stat <- matrix(nrow=B,ncol=4)
    while(b<=B){
      xstar            <- sample(x,replace=TRUE)
      EDFstar          <- ecdf(xstar)(xstar)
      MLExstar         <- try(MLE(xstar),silent=TRUE)
      MDE.LSxstar      <- try(MDE.LS(xstar),silent=TRUE)
      weib.est.star    <- try(eweibull(xstar)$parameters,silent=TRUE)
      gamm.est.star   <- MASS::fitdistr(xstar, "gamma", start=list(shape=1, scale=1))$estimate
      
      if(!any(is.character(MLExstar),
              is.character(MDE.LSxstar),
              is.character(weib.est.star),
              is.character(gamm.est.star)
      )){
        #LOMAX - MLE
        BS.stat[b,1]    <- max( abs(EDFstar - pLomax(xstar,MLExstar$beta,MLExstar$sigma) ))
        
        #LOMAX - MDE.SD
        BS.stat[b,2]    <- max( abs(EDFstar - pLomax(xstar,MDE.LSxstar$beta,MDE.LSxstar$sigma) ))
        
        #WEIBULL
        weib.shape.star <- weib.est.star["shape"]
        weib.scale.star <- weib.est.star["scale"]
        BS.stat[b,3]    <- max( abs(EDFstar - pweibull(xstar,shape=weib.shape.star,scale=weib.scale.star)))
        
        #GAMMA
        gamm.shape.star <- gamm.est.star["shape"]
        gamm.scale.star <- gamm.est.star["scale"]
        BS.stat[b,6]    <- max( abs(EDFstar - pgamma(xstar,shape=gamm.shape.star,scale=gamm.scale.star)))
        
        b <- b+1
      }
    }
    
    pvalue <- numeric(4)
    pvalue[1] <- mean(BS.stat[,1] > KS.stat[1])
    pvalue[2] <- mean(BS.stat[,2] > KS.stat[2])
    pvalue[3] <- mean(BS.stat[,3] > KS.stat[3])
    pvalue[4] <- mean(BS.stat[,4] > KS.stat[4])
    
    pvalue.char <- as.character(pvalue)
    pvalue.char <- paste0(" (",pvalue.char,")")
    pvalue.char <- c(pvalue.char,"")
    
    my.legend <- paste0(c("Lomax - MLE","Lomax - MDE.SD","Weibull","Gamma","EDF"),pvalue.char)
    my.col    <- c("red","forestgreen","orange2","dodgerblue3","mediumpurple1")
    my.lty    <- c(1,2,4,5,1)
    my.lwd    <- c(1.5,1.5,1.5,1.5,2)
    
    xseq <- seq(min(x)*0.9,max(x)*1.1,length=1000)
    
    if(printPDF)
      pdf(file=paste0("C:/Temp/FittedDists.CDF.",tim,".pdf"),width=8,height=4)
    plot(ecdf(x),main="",xlab=namex,ylab=expression(P(X <= x))             ,lty=my.lty[5],lwd=my.lwd[5],col=my.col[5], xlim=c(0,xlimmax))
    legend(x="bottomright",legend=my.legend                                ,lty=my.lty   ,lwd=my.lwd   ,col=my.col)
    lines(xseq,             pLomax(xseq,    MLEx$beta,     MLEx$sigma)     ,lty=my.lty[1],lwd=my.lwd[1],col=my.col[1])
    lines(xseq,             pLomax(xseq,    MDE.LSx$beta,  MDE.LSx$sigma)  ,lty=my.lty[2],lwd=my.lwd[2],col=my.col[2])
    lines(xseq,           pweibull(xseq,shape=weib.shape,scale=weib.scale) ,lty=my.lty[3],lwd=my.lwd[3],col=my.col[3])
    lines(xseq,             pgamma(xseq,shape=gamm.shape,scale=gamm.scale) ,lty=my.lty[6],lwd=my.lwd[6],col=my.col[6])
    if(printPDF)
      dev.off()
    
    my.legend <- paste0(c("Lomax - MLE","Lomax - MDE.SD","Weibull","Gamma","BC.KDE"),pvalue.char)
    if(printPDF)
      pdf(file=paste0("C:/Temp/FittedDists.PDF.",tim,".pdf"),width=8,height=4)
    dx        <- data.frame(x=xseq,y=dbckden(xseq,x,bw=bw.nrd0(x)))
    ylimmax   <- max(dx$y)*1.2
    hist(x,main="",xlab=namex,freq=FALSE,ylim=c(0,ylimmax), xlim=c(0,xlimmax))
    legend(x="topright",legend=my.legend                                    ,lty=my.lty   ,lwd=my.lwd   ,col=my.col)
    lines(xseq,             dx$y                                            ,lty=my.lty[5],lwd=my.lwd[5],col=my.col[5])
    lines(xseq,             dLomax(xseq,    MLEx$beta,     MLEx$sigma)      ,lty=my.lty[1],lwd=my.lwd[1],col=my.col[1])
    lines(xseq,             dLomax(xseq,    MDE.LSx$beta,     MDE.LSx$sigma)      ,lty=my.lty[2],lwd=my.lwd[2],col=my.col[2])
    lines(xseq,             dweibull(xseq,shape=weib.shape,scale=weib.scale),lty=my.lty[3],lwd=my.lwd[3],col=my.col[3])
    lines(xseq,             dgamma(xseq,shape=gamm.shape,scale=gamm.scale)  ,lty=my.lty[6],lwd=my.lwd[6],col=my.col[6])
    if(printPDF)
      dev.off()
    answr <- list(estimators=est,p.values=pvalue)
  }else if(PvalAIC == "aic"){
    AIC <- numeric(3)
    #AIC Lomax
    AIC[1]<- 4-2*sum(log(dLomax(x,MLEx$beta,MLEx$sigma)))
    #AIC Weibull
    AIC[2]<- 4-2*sum(log(dweibull(x,shape=weib.shape,scale=weib.scale)))
    #AIC Gamma
    AIC[3]<- 4-2*sum(log(dgamma(x,shape=gamm.shape,scale=gamm.scale)))

    names(AIC) <- c("Lomax","Weibull","Gamma")
    
    AIC.char    <- as.character(round(AIC[c(1,1,2,3)],1))
    AIC.char <- paste0(" (",AIC.char,")")
    AIC.char[c(2,5)] <- ""
    
    my.legend <- paste0(c("Lomax - MLE","Lomax - MDE.SD","Weibull","Gamma","EDF"),AIC.char)
    my.col    <- c("red","forestgreen","orange2","dodgerblue3","mediumpurple1")
    my.lty    <- c(1,2,4,5,1)
    my.lwd    <- c(1.5,1.5,1.5,1.5,2)
    
    xseq <- seq(min(x)*0.9,max(x)*1.1,length=1000)
    
    if(printPDF)
      pdf(file=paste0("C:/Temp/FittedDists.CDF.",tim,".pdf"),width=8,height=4)
    plot(ecdf(x),main="",xlab=namex,ylab=expression(P(X <= x))    ,lty=my.lty[5],lwd=my.lwd[5],col=my.col[5], xlim=c(0,xlimmax))
    legend(x="bottomright",legend=my.legend                                ,lty=my.lty   ,lwd=my.lwd   ,col=my.col)
    lines(xseq,             pLomax(xseq,    MLEx$beta,     MLEx$sigma)     ,lty=my.lty[1],lwd=my.lwd[1],col=my.col[1])
    lines(xseq,             pLomax(xseq,    MDE.LSx$beta,  MDE.LSx$sigma)  ,lty=my.lty[2],lwd=my.lwd[2],col=my.col[2])
    lines(xseq,           pweibull(xseq,shape=weib.shape,scale=weib.scale) ,lty=my.lty[3],lwd=my.lwd[3],col=my.col[3])
    lines(xseq,       pgamma(xseq,shape=gamm.shape,scale=gamm.scale)       ,lty=my.lty[4],lwd=my.lwd[4],col=my.col[4])
    if(printPDF)
      dev.off()
    
    my.legend <- paste0(c("Lomax - MLE","Lomax - MDE.SD","Weibull","Gamma","BC.KDE"),AIC.char)
    
    if(printPDF)
      pdf(file=paste0("C:/Temp/FittedDists.PDF.",tim,".pdf"),width=8,height=4)
    dx      <- data.frame(x=xseq,y=dbckden(xseq,x,bw=bw.nrd0(x)))
    ylimmax <- max(dx$y)*1.2
    hist(x,main="",xlab=namex,freq=FALSE,ylim=c(0,ylimmax), xlim=c(0,xlimmax))
    legend(x="topright",legend=my.legend                                    ,lty=my.lty   ,lwd=my.lwd   ,col=my.col)
    lines(xseq,             dx$y                                            ,lty=my.lty[5],lwd=my.lwd[5],col=my.col[5])
    lines(xseq,             dLomax(xseq,    MLEx$beta,     MLEx$sigma)      ,lty=my.lty[1],lwd=my.lwd[1],col=my.col[1])
    lines(xseq,             dLomax(xseq,    MDE.LSx$beta,     MDE.LSx$sigma)      ,lty=my.lty[2],lwd=my.lwd[2],col=my.col[2])
    lines(xseq,             dweibull(xseq,shape=weib.shape,scale=weib.scale),lty=my.lty[3],lwd=my.lwd[3],col=my.col[3])
    lines(xseq,               dgamma(xseq,shape=gamm.shape,scale=gamm.scale),lty=my.lty[4],lwd=my.lwd[4],col=my.col[4])
    if(printPDF)
      dev.off()
    
    answr <- list(estimators=est,AIC=AIC)
  }else{
    warning("Specify PvalAIC correctly (must be either 'p' or 'aic').")
    answr <- NULL
  }
  return(answr)
}

graphsnstuff(aircomtra,PvalAIC="aic",namex="Repair times, x",xlimmax=15,printPDF=TRUE)
graphsnstuff(Fitres_w,PvalAIC="aic",namex="Residuals, x",xlimmax=5,printPDF=TRUE)



